name: Auto Deploy to Kucingarong

on:
  push:
    branches:
      - main
      - development
      - feature/**

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Zip Repository
        run: zip -r deploy.zip . -x "*.git*" "*.github*"

      - name: Deploy to Kucingarong AutoHost
        env:
          AUTOHOST_URL: "https://cicak.akhzafachrozy.my.id"
          REPO_NAME: ${{ github.event.repository.name }}
        run: |
          echo "ðŸš€ Deploying $REPO_NAME to $AUTOHOST_URL..."
          RESPONSE=$(curl -s -S -k -m 240 --connect-timeout 15 \
            -X POST \
            -F "repo=$REPO_NAME" \
            -F "file=@deploy.zip" \
            "$AUTOHOST_URL")
          echo "ðŸ“œ ===== RESPONSE ====="
          echo "$RESPONSE"
          echo "ðŸ“œ ===================="
